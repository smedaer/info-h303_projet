DROP DATABASE IF EXISTS horeca;
CREATE DATABASE horeca CHARACTER SET 'utf8';
use horeca;

CREATE TABLE Etablissements (
	Eta_ID		INTEGER UNSIGNED UNIQUE AUTO_INCREMENT,
	Name		VARCHAR(30) NOT NULL,
	AdRue		VARCHAR(50),
	AdNumero	SMALLINT UNSIGNED,
	AdCodePostal	SMALLINT UNSIGNED,
	Longitude	SMALLINT UNSIGNED,
	Latitude	SMALLINT UNSIGNED,
	Tel		INTEGER UNSIGNED,
	PRIMARY KEY (Eta_ID)
);

CREATE TABLE Restaurants (
	Rest_ID		INTEGER UNSIGNED REFERENCES Etablissements (Eta_ID),
	Prix		SMALLINT UNSIGNED,
	Couverts	SMALLINT UNSIGNED,
	Emporter	BOOLEAN,
	Livraison	BOOLEAN,
	Fermeture	BOOLEAN,
	PRIMARY KEY (Rest_ID)
);

CREATE TABLE Cafes (
	Cafe_ID		INTEGER UNSIGNED REFERENCES Etablissements (Eta_ID),
	Fumeur		BOOLEAN,
	Restauration	BOOLEAN,
	PRIMARY KEY (Cafe_ID)
);

CREATE TABLE Hotels (
	Hot_ID		INTEGER UNSIGNED REFERENCES Etablissements (Eta_ID),
	Prix		SMALLINT UNSIGNED,
	Chambres	SMALLINT UNSIGNED,
	Etoiles		SMALLINT UNSIGNED,
	PRIMARY KEY (Hot_ID)
);


CREATE TABLE Users (
	User_ID		INTEGER UNSIGNED UNIQUE AUTO_INCREMENT,
	Name		VARCHAR(20),
	Email		VARCHAR(40),
	PSWD		VARCHAR(20),
	Creation_date	DATE,
	Admin		BOOLEAN,
	PRIMARY KEY (User_ID)
);

CREATE TABLE Descriptions (
	Des_ID		INTEGER UNSIGNED UNIQUE AUTO_INCREMENT,
	Creation_date	DATE,
	User_ID		INTEGER UNSIGNED,
	Eta_ID		INTEGER UNSIGNED,
	PRIMARY KEY (Des_ID),
	FOREIGN KEY (User_ID) REFERENCES Users(User_ID),
	FOREIGN KEY (Eta_ID) REFERENCES Etablissements(Eta_ID)
);

CREATE TABLE Commentaires (
	Com_ID		INTEGER UNSIGNED REFERENCES Descriptions (Des_ID),
	Com		TEXT,
	Score		SMALLINT UNSIGNED,
	PRIMARY KEY (Com_ID)
);

CREATE TABLE Labels (
	Lab_ID		INTEGER UNSIGNED REFERENCES Descriptions (Des_ID),
	Label		VARCHAR(40),
	PRIMARY KEY (Lab_ID)
);


